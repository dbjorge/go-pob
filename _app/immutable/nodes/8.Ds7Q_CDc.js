import{c as _t,a as j,t as ne}from"../chunks/disclose-version.BiKuDWK2.js";import{M as kt,N as bt,O as wt,p as ht,a as _,g as t,P as D,h as W,b as Ze,e as Dt,s as x,i as c,c as i,r,H as yt,j as et,k as tt}from"../chunks/runtime.BLVj8dz7.js";import{s as xt}from"../chunks/render.BuL6tNdg.js";import{i as lt}from"../chunks/this.Dx7VmjCJ.js";import{e as at,i as st}from"../chunks/each.CwAL-BON.js";import{r as se}from"../chunks/attributes.DpYvJWZY.js";import{d as gt,s as Pt,g as ie,a as T,c as he,m as Lt,b as It,i as fe}from"../chunks/props.BmCjkDKm.js";import{a as oe}from"../chunks/input.CgTgWgY3.js";import{G as Et,b as Me}from"../chunks/cache.CURTroju.js";import{N as Ge}from"../chunks/NumberInput.K2RCBNXe.js";import{I as Ct}from"../chunks/Input.DO4VF3XX.js";import{s as Tt,l as S,c as A,U as At}from"../chunks/global.O_lnPexJ.js";import{w as Qe}from"../chunks/index.Bnwk7SW7.js";import{S as Nt,a as Mt,b as Qt}from"../chunks/SelectSelection.CojTaN6k.js";import{o as Bt}from"../chunks/index-client.CWFbZt41.js";import{c as De}from"../chunks/colors.DCgE6yJT.js";const Ft=[];function $t(o,k=!1){return ye(o,new Map,"",Ft)}function ye(o,k,b,a,m=null){if(typeof o=="object"&&o!==null){const re=k.get(o);if(re!==void 0)return re;if(o instanceof Map)return new Map(o);if(o instanceof Set)return new Set(o);if(kt(o)){const h=[];k.set(o,h),m!==null&&k.set(m,h);for(let v=0;v<o.length;v+=1)h.push(ye(o[v],k,b,a));return h}if(bt(o)===wt){const h={};k.set(o,h),m!==null&&k.set(m,h);for(var _e in o)h[_e]=ye(o[_e],k,b,a);return h}if(o instanceof Date)return structuredClone(o);if(typeof o.toJSON=="function")return ye(o.toJSON(),k,b,a,o)}if(o instanceof EventTarget)return o;try{return structuredClone(o)}catch{return o}}const Be=o=>o;var Ot=ne("<option> </option>"),Rt=ne('<div slot="selection"><!></div>'),Vt=ne('<div slot="item"><!></div>'),jt=ne('<button class="container font-bold">X</button> <div class="min-w-full themed"><!></div> <!> <div class="container select-wrapper"><select class="input"><option>Default</option></select></div> <!> <input type="checkbox" class="text-2xl"> <!>',1),Wt=(o,k)=>k(),Ht=ne('<div class="flex flex-col min-w-[30em] gap-2"><!> <div class="flex flex-row w-full justify-between"><div class="flex flex-row items-center gap-2"><span>Socketed in:</span> <div class="container select-wrapper"><select class="input"><option>None</option></select></div></div> <div class="flex flex-row items-center gap-2"><span>Enabled:</span> <input type="checkbox" class="text-2xl"></div> <div class="flex flex-row items-center gap-2"><span>Include in Full DPS:</span> <input type="checkbox" class="text-2xl"></div></div> <div class="grid gem-grid gap-1 w-full svelte-10n7688"><div></div> <div>Gem Name</div> <div>Level</div> <div>Variant</div> <div>Quality</div> <div>Enabled</div> <div>Count</div> <!> <div class="col-span-7 w-full mt-2"><button class="container font-bold min-w-full">Add Skill Gem</button></div></div></div>'),Jt=ne('<div class="p-2 px-4 w-full h-full overflow-y-auto"><div class="flex flex-row gap-4 max-xl:flex-wrap"><div class="flex flex-col min-w-[24em] gap-2"><div class="flex flex-row items-center gap-2"><span>Skill set:</span> <div class="container select-wrapper flex-1"><select class="input"><option>Default</option></select></div> <button class="container">Manage...</button></div> <div class="flex flex-row items-center gap-2"><span class="flex-1">Socket Groups:</span> <button class="container">New</button> <button class="container">Delete All</button> <button class="container">Delete</button></div> <select class="bg-black border w-full border-neutral-400 flex-1 select-many max-h-[19em]" size="18"></select> <p class="text-sm">Usage Tips:<br> - You can copy/paste socket groups using Ctrl+C and Ctrl+V.<br> - Ctrl + Click to enable/disable socket groups.<br> - Ctrl + Right click to include/exclude in FullDPS calculations.<br> - Right click to set as the Main skill group.<br></p> <fieldset class="border border-white bg-neutral-900 p-2"><legend class="container">Gem Options</legend> <div class="side-by-side-max-content"><span>Sort gems by DPS:</span> <div class="flex flex-row gap-2"><input type="checkbox" class="text-2xl"> <div class="container select-wrapper"><select class="input"><option>Full DPS</option><option>Combined DPS</option><option>Total DPS</option><option>Average Hit</option><option>DoT DPS</option><option>Bleed DPS</option><option>Ignite DPS</option><option>Poison DPS</option></select></div></div> <span>Match gems character level:</span> <div class="flex flex-row gap-2"><input type="checkbox" class="text-2xl"></div> <span>Default gem level:</span> <!> <span>Default gem quality:</span> <!> <span>Show support gems:</span> <div class="flex flex-row gap-2"><div class="container select-wrapper"><select class="input"><option>All</option><option>Non-Awakened</option><option>Awakened</option></select></div></div> <span>Show gem quality variants:</span> <div class="flex flex-row gap-2"><input type="checkbox" class="text-2xl"></div></div></fieldset></div> <!></div></div>');function cl(o,k){ht(k,!0);const b=Pt(),a=()=>he(A,"$currentBuild",b),m=()=>he(N,"$currentGemGroup",b),_e=()=>he(ce,"$mainSocketGroup",b),re=()=>he(ke,"$socketGroupLabel",b);let h=W(1);_(()=>{var e,l,s;(s=(l=(e=a())==null?void 0:e.Skills)==null?void 0:l.SkillSets)==null||s.then(u=>x(h,T((u==null?void 0:u.length)||0))).catch(S)});let v=W(1);_(()=>{var e,l,s;(s=(l=(e=a())==null?void 0:e.Skills)==null?void 0:l.ActiveSkillSet)==null||s.then(u=>x(v,T(u))).catch(S)});let G=W(0);const ce=Qe(-1);_(()=>{var e,l,s;(s=(l=(e=a())==null?void 0:e.Build)==null?void 0:l.MainSocketGroup)==null||s.then(u=>ce.set(u-1)).catch(S)}),ce.subscribe(e=>{var l;e>=0&&((l=Tt)==null||l.SetMainSocketGroup(e+1).catch(S)),A.set(a())});let xe=W(!0);const ke=Qe("");_(()=>{var e,l,s,u,f;(f=(u=(s=(l=(e=a())==null?void 0:e.Skills)==null?void 0:l.SkillSets)==null?void 0:s[t(v)-1].Skills)==null?void 0:u[t(G)])==null||f.Label.then(L=>{x(xe,!0),ke.set(L),x(xe,!1)}).catch(S)}),ke.subscribe(e=>{t(xe)||!a()||ie(A,D(a).Skills.SkillSets[t(v)-1].Skills[t(G)].Label=e,D(a))});const it=(e,l)=>{l.preventDefault(),l.stopPropagation(),ce.set(e)};let ue=W(T([]));const Fe=T({}),ot={STR:De.STRENGTH,DEX:De.DEXTERITY,INT:De.INTELLIGENCE,NONE:De.NORMAL};Bt(()=>{Et().then(e=>{x(ue,T(e.map(l=>({label:"^"+ot[l.GemType]+l.Base.Name,value:l.ID,data:l})))),e.forEach(l=>{Fe[l.ID]=l})}).catch(S)});let ge=W(!0);const N=Qe();_(()=>{t(ue).length<=0||new Promise(async()=>{var s,u,f,L,B;const e=(B=(L=(f=(u=(s=a())==null?void 0:s.Skills)==null?void 0:u.SkillSets)==null?void 0:f[t(v)-1])==null?void 0:L.Skills)==null?void 0:B[t(G)];if(!e){N.set(void 0);return}const l=[];if(e.Gems&&await e.Gems){const M=await e.Gems.length;for(let I=0;I<M;(I+=1)-1){const p=e.Gems[I],Q=await p.GemID;l.push({GemListValue:t(ue).find(E=>E.value===Q),GemID:Q,Quality:await p.Quality,Enabled:await p.Enabled,EnableGlobal1:await p.EnableGlobal1,EnableGlobal2:await p.EnableGlobal2,QualityID:await p.QualityID,Count:await p.Count,Level:await p.Level,SkillPart:await p.SkillPart,SkillPartCalcs:await p.SkillPartCalcs,NameSpec:await p.NameSpec,SkillID:await p.SkillID,SkillMinionItemSet:await p.SkillMinionItemSet,SkillMinion:await p.SkillMinion})}}x(ge,!0),N.set({Gems:l,Enabled:await e.Enabled,IncludeInFullDPS:await e.IncludeInFullDPS,Slot:await e.Slot}),x(ge,!1)}).catch(S)});let $e="";N.subscribe(async e=>{var s,u;if(t(ge)||!e||!a()||!await a().Skills||!await a().Skills.SkillSets||!await a().Skills.SkillSets[t(v)-1]||!await a().Skills.SkillSets[t(v)-1].Skills||!await a().Skills.SkillSets[t(v)-1].Skills[t(G)])return;const l=JSON.stringify(e);$e!==l&&($e=l,ie(A,D(a).Skills.SkillSets[t(v)-1].Skills[t(G)].Slot=Be(e.Slot),D(a)),ie(A,D(a).Skills.SkillSets[t(v)-1].Skills[t(G)].Enabled=Be(e.Enabled),D(a)),ie(A,D(a).Skills.SkillSets[t(v)-1].Skills[t(G)].IncludeInFullDPS=Be(e.IncludeInFullDPS),D(a)),e.Gems&&await((u=(s=a())==null?void 0:s.SetSocketGroupGems)==null?void 0:u.call(s,t(v)-1,t(G),$t(e.Gems.map(f=>({...f,GemID:f.GemListValue.value}))))),At("currentGemGroup"))});let be=W(T([]));_(()=>{var e,l,s,u,f;(f=(u=(s=(l=(e=a())==null?void 0:e.Skills)==null?void 0:l.SkillSets)==null?void 0:s[t(v)-1])==null?void 0:u.Skills)==null||f.then(async L=>{var M,I,p,Q,E,pe,ve,H,J,de,U,X,q,K,Y,z,Z,ee,me,te;const B=[];for(let C=0;C<L.length;(C+=1)-1){let g=await((E=(Q=(p=(I=(M=a())==null?void 0:M.Skills)==null?void 0:I.SkillSets)==null?void 0:p[t(v)-1])==null?void 0:Q.Skills)==null?void 0:E[C].Label);if(g===""){const le=(de=(J=(H=(ve=(pe=a())==null?void 0:pe.Skills)==null?void 0:ve.SkillSets)==null?void 0:H[t(v)-1])==null?void 0:J.Skills)==null?void 0:de[C].Gems;if(await le)for(let F=0;F<await le.length;(F+=1)-1){const ae=Fe[await le[F].GemID];!ae||ae.Support||(g!==""&&(g+=", "),g+=ae.Base.Name)}else g="<No active skills>"}g&&B.push({label:g,enabled:await((Y=(K=(q=(X=(U=a())==null?void 0:U.Skills)==null?void 0:X.SkillSets)==null?void 0:q[t(v)-1])==null?void 0:K.Skills)==null?void 0:Y[C].Enabled),fullDPS:await((te=(me=(ee=(Z=(z=a())==null?void 0:z.Skills)==null?void 0:Z.SkillSets)==null?void 0:ee[t(v)-1])==null?void 0:me.Skills)==null?void 0:te[C].IncludeInFullDPS)||!1})}x(be,T(B))}).catch(S)});const nt=e=>{var l,s;(s=(l=m())==null?void 0:l.Gems)==null||s.splice(e,1),N.set(m())},rt=()=>{var l,s;const e=t(ue)[0];(s=(l=m())==null?void 0:l.Gems)==null||s.push({GemListValue:e,Quality:0,SkillPart:1,EnableGlobal2:!0,SkillPartCalcs:1,QualityID:"Default",GemID:"Metadata/Items/Gems/SkillGemFireball",Enabled:!0,Count:1,EnableGlobal1:!0,NameSpec:e.value,Level:1,SkillID:e.value,SkillMinionItemSet:1,SkillMinion:"SummonedPhantasm"}),N.set(m())},n=T({sortGemsByDPS:!0,sortGemsByDPSField:"FullDPS",matchGemLevelToCharacterLevel:!1,defaultGemLevel:20,defaultGemQuality:0,showSupportGemTypes:"ALL",showAltQualityGems:!1});_(()=>{var e;(e=a())==null||e.SetSortGemsByDPS(n.sortGemsByDPS).catch(S)}),_(()=>{var e;(e=a())==null||e.SetSortGemsByDPSField(n.sortGemsByDPSField).catch(S)}),_(()=>{var e;(e=a())==null||e.SetMatchGemLevelToCharacterLevel(n.matchGemLevelToCharacterLevel).catch(S)}),_(()=>{var e;(e=a())==null||e.SetDefaultGemLevel(n.defaultGemLevel).catch(S)}),_(()=>{var e;(e=a())==null||e.SetDefaultGemQuality(n.defaultGemQuality).catch(S)}),_(()=>{var e;(e=a())==null||e.SetShowSupportGemTypes(n.showSupportGemTypes).catch(S)}),_(()=>{var e;(e=a())==null||e.SetShowAltQualityGems(n.showAltQualityGems).catch(S)}),_(()=>{var e,l;(l=(e=a())==null?void 0:e.Skills)==null||l.then(s=>{n.sortGemsByDPS=s.SortGemsByDPS,n.sortGemsByDPSField=s.SortGemsByDPSField,n.matchGemLevelToCharacterLevel=s.MatchGemLevelToCharacterLevel,n.defaultGemLevel=parseInt(s.DefaultGemLevel||n.defaultGemLevel.toString()),n.defaultGemQuality=s.DefaultGemQuality||n.defaultGemQuality,n.showSupportGemTypes=s.ShowSupportGemTypes,n.showAltQualityGems=s.ShowAltQualityGems}).catch(S)});const ct=async()=>{var e;await((e=a())==null?void 0:e.AddNewSocketGroup()),A.set(a())},ut=async()=>{var e;await((e=a())==null?void 0:e.DeleteSocketGroup(t(G))),x(G,0),A.set(a())},pt=async()=>{var e,l;await((e=a())==null?void 0:e.DeleteAllSocketGroups()),await((l=a())==null?void 0:l.AddNewSocketGroup()),x(G,0),ce.set(0),A.set(a())};var Oe=_t(),vt=Ze(Oe);lt(vt,a,e=>{var l=Jt(),s=c(l),u=c(s),f=c(u),L=i(c(f),2),B=c(L);r(L),yt(2),r(f);var M=i(f,2),I=i(c(M),2);I.__click=ct;var p=i(I,2);p.__click=pt;var Q=i(p,2);Q.__click=ut,r(M);var E=i(M,2);at(E,21,()=>t(be),st,(d,$,O)=>{var P=Ot();P.value=(P.__value=O)==null?"":O,P.__contextmenu=we=>it(O,we);var Se=c(P);r(P),et(()=>xt(Se,`${t($).label??""}
              ${(t($).enabled?"":" (Disabled)")??""}
              ${(_e()===O?" (Active)":"")??""}
              ${(t($).fullDPS?" (FullDPS)":"")??""}`)),j(d,P)}),r(E);var pe=i(E,4),ve=i(c(pe),2),H=i(c(ve),2),J=c(H);se(J);var de=i(J,2),U=c(de),X=c(U);X.value=(X.__value="FullDPS")==null?"":"FullDPS";var q=i(X);q.value=(q.__value="CombinedDPS")==null?"":"CombinedDPS";var K=i(q);K.value=(K.__value="TotalDPS")==null?"":"TotalDPS";var Y=i(K);Y.value=(Y.__value="AverageDamage")==null?"":"AverageDamage";var z=i(Y);z.value=(z.__value="TotalDot")==null?"":"TotalDot";var Z=i(z);Z.value=(Z.__value="BleedDPS")==null?"":"BleedDPS";var ee=i(Z);ee.value=(ee.__value="IgniteDPS")==null?"":"IgniteDPS";var me=i(ee);me.value=(me.__value="TotalPoisonDPS")==null?"":"TotalPoisonDPS",r(U),r(de),r(H);var te=i(H,4),C=c(te);se(C),r(te);var g=i(te,4);Ge(g,{min:1,max:40,get value(){return n.defaultGemLevel},set value(d){n.defaultGemLevel=d}});var le=i(g,4);Ge(le,{min:0,max:30,get value(){return n.defaultGemQuality},set value(d){n.defaultGemQuality=d}});var F=i(le,4),ae=c(F),Pe=c(ae),Le=c(Pe);Le.value=(Le.__value="ALL")==null?"":"ALL";var Ie=i(Le);Ie.value=(Ie.__value="NORMAL")==null?"":"NORMAL";var Re=i(Ie);Re.value=(Re.__value="AWAKENED")==null?"":"AWAKENED",r(Pe),r(ae),r(F);var Ve=i(F,4),je=c(Ve);se(je),r(Ve),r(ve),r(pe),r(u);var dt=i(u,2);lt(dt,m,d=>{var $=Ht(),O=c($);Ct(O,{prefix:"Label:",fullWidth:!0,get value(){return Lt(),re()},set value(R){It(ke,T(R))}});var P=i(O,2),Se=i(c(P),2),we=i(c(Se),2);se(we),r(Se);var We=i(Se,2),He=i(c(We),2);se(He),r(We),r(P);var Je=i(P,2),Ue=i(c(Je),14);at(Ue,1,()=>m().Gems,st,(R,y,St)=>{var qe=jt(),Ke=Ze(qe);Ke.__click=()=>nt(St);var Ee=i(Ke,2),ft=c(Ee);Nt(ft,{get value(){return t(y).GemListValue},set value(w){t(y).GemListValue=w,fe(b,"$currentGemGroup")},get items(){return t(ue)},clearable:!1,placeholder:"",showChevron:!0,listOffset:0,$$slots:{selection:(w,Te)=>{var V=Rt();const Ae=tt(()=>Te.selection);var Ne=c(V);Mt(Ne,{get item(){return t(Ae)}}),r(V),j(w,V)},item:(w,Te)=>{var V=Vt();const Ae=tt(()=>Te.item);var Ne=c(V);Qt(Ne,{get item(){return t(Ae)}}),r(V),j(w,V)}}}),r(Ee);var Ye=i(Ee,2);Ge(Ye,{min:1,get max(){return t(y).GemListValue.data.MaxLevel},get value(){return t(y).Level},set value(w){t(y).Level=w,fe(b,"$currentGemGroup")}});var ze=i(Ye,4);Ge(ze,{min:0,max:30,get value(){return t(y).Quality},set value(w){t(y).Quality=w,fe(b,"$currentGemGroup")}});var Ce=i(ze,2);se(Ce);var Gt=i(Ce,2);Ge(Gt,{min:1,max:99,get value(){return t(y).Count},set value(w){t(y).Count=w,fe(b,"$currentGemGroup")}}),oe(Ce,()=>t(y).Enabled,w=>(t(y).Enabled=w,fe(b,"$currentGemGroup"))),j(R,qe)});var Xe=i(Ue,2),mt=c(Xe);mt.__click=[Wt,rt],r(Xe),r(Je),r($),oe(we,()=>m().Enabled,R=>ie(N,D(m).Enabled=R,D(m))),oe(He,()=>m().IncludeInFullDPS,R=>ie(N,D(m).IncludeInFullDPS=R,D(m))),j(d,$)}),r(s),r(l),et(()=>{B.disabled=t(h)===1,p.disabled=t(be).length<=1,Q.disabled=t(G)<0||t(be).length<=1}),Me(E,()=>t(G),d=>x(G,d)),oe(J,()=>n.sortGemsByDPS,d=>n.sortGemsByDPS=d),Me(U,()=>n.sortGemsByDPSField,d=>n.sortGemsByDPSField=d),oe(C,()=>n.matchGemLevelToCharacterLevel,d=>n.matchGemLevelToCharacterLevel=d),Me(Pe,()=>n.showSupportGemTypes,d=>n.showSupportGemTypes=d),oe(je,()=>n.showAltQualityGems,d=>n.showAltQualityGems=d),j(e,l)}),j(o,Oe),Dt()}gt(["click","contextmenu"]);export{cl as component};
